this.RRBLUP.pred.acc <- rrblup.kfoldfoldCV(Y = this.phenotype.input.file, Geno = myG,
traitname = colnames(this.phenotype.input.file)[2],
path.for.results = "Test_20231013",
number.of.folds = 5, seed.number = this.seed.number)
# Step 8: Store the mean in the list
RRBLUP_list[[trait]] <- this.RRBLUP.pred.acc
}
# Step 9: Create an R object (data frame) with means for each trait
RRBLUP_PAs <- data.frame(Trait = phenotypic_traits, Mean = unlist(RRBLUP_list))
# Print the results or save them as needed
print(RRBLUP_PAs)
#Output the prediction accuracies (RRBLUP_PAs) as a i.) csv file, and ii.) box plot
this.simulation.setting <- "Large qtl H0.2"
H4.or.H6 <- "H6"
RRBLUP.or.multiBLUP <- "RRBLUP"
#csv.file
write.csv(RRBLUP_PAs, paste("Mean.5.fold.CV.PA.",H4.or.H6,".",this.simulation.setting, ".", RRBLUP.or.multiBLUP,".csv" , sep = ""),
row.names = FALSE)
#box plot
this.mean <- mean(RRBLUP_PAs$Mean)
pdf(paste("Boxplot.Mean.5.fold.CV.PA.",H4.or.H6,".",this.simulation.setting, ".", RRBLUP.or.multiBLUP,".pdf", sep = ""))
boxplot(RRBLUP_PAs$Mean, col = "green", ylim = c(-0.5,1.0),
xlab =  "Setting",
ylab = "Mean 5-fold CV PA across 100 replicate traits")
points(this.mean, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
#Step:1  load data multiBLUP
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H6/Simulation/Simulated_Traits/Large qtl H0.8/")
myY <- read.table("Simulated_Data_100_Reps_Herit_0.2.txt", head = TRUE)
dir.create("Test_20231011")
library(sommer)
setwd("/Users/sarahjw2/Box//Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/AEL_Experimental_Pipeline/Scripts_to_Read_In_Exp")
source("hey.where.are.my.SNPs.R")
source("k.fold.CV.Function.Multi.BLUP.output.accuracy.in.Rstudio.R")
setwd(home.dir)
# Step 2: Initialize an empty list to store the means
MultiBLUP_list <- list()
# Step 3: Define the phenotypic traits
phenotypic_traits <- colnames(myY)[-(1)]
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H6/Simulation/Simulated_Traits/Large qtl H0.2/")
#Read in a csv file containing the Chromosome and bp positon of SNPs of interest
these.regions.of.interest <- read.csv("Chr.bp.pos.largeqtn.H0.2.csv", head = TRUE)
#Read in a csv file containing the Chromosome and bp positon of SNPs of interest
these.regions.of.interest <- read.csv("Chr.bp.pos.largeqtn.H0.2.csv", head = TRUE)
View(these.regions.of.interest)
#Find the indices of the SNPs in the vicinity of the region of interest
put.these.row.numbers.of.SNPs.into.separate.kernel <- hey.where.are.my.snps(regions.of.interest = these.regions.of.interest,
G = myG)
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H6/Simulation/Simulated_Traits/Large qtl H0.2/")
# Step 4: Iterate through each phenotypic trait
for (trait in phenotypic_traits) {
print(paste("Yee-haw! We're starting on trait: ",trait, sep = ""))
this.phenotype.input.file <- myY[,c(1, which(colnames(myY) == trait))]
# Step 6: Calculate the mean using multi.BLUP.kfoldfoldCV
this.Multi.BLUP.pred.acc <- try(multi.BLUP.kfoldfoldCV(Y = this.phenotype.input.file, Geno = myG,
traitname = colnames(this.phenotype.input.file)[2],
path.for.results = "Test_20231011",
row.number.of.SNPs.in.separate.kernel = put.these.row.numbers.of.SNPs.into.separate.kernel,
number.of.folds = 5, seed.number = this.seed.number), silent = TRUE)
if(inherits(this.Multi.BLUP.pred.acc, "try-error")){
print(paste("Aw shucks!!!!!!! This trait's model failed to converge in one of the folds: ",trait, sep = ""))
this.Multi.BLUP.pred.acc <- NA
}
# Step 8: Store the mean in the list
MultiBLUP_list[[trait]] <- this.Multi.BLUP.pred.acc
}
# Step 9: Create an R object (data frame) with means for each trait
MultiBLUP_PAs <- data.frame(Trait = phenotypic_traits, Mean = unlist(MultiBLUP_list))
# Print the results or save them as needed
print(MultiBLUP_PAs)
#Output the prediction accuracies (multiBLUP) as a i.) csv file, and ii.) box plot
this.simulation.setting <- "Large qtl H0.2"
H4.or.H6 <- "H6"
RRBLUP.or.multiBLUP <- "multiBLUP"
#csv.file
write.csv(MultiBLUP_PAs, paste("Mean.5.fold.CV.PA.",H4.or.H6,".",this.simulation.setting, ".", RRBLUP.or.multiBLUP,".csv" , sep = ""),
row.names = FALSE)
#box plot
this.mean <- mean(MultiBLUP_PAs$Mean[which(!is.na(MultiBLUP_PAs$Mean))])
pdf(paste("Boxplot.Mean.5.fold.CV.PA.",H4.or.H6,".",this.simulation.setting, ".", RRBLUP.or.multiBLUP,".pdf", sep = ""))
boxplot(MultiBLUP_PAs$Mean, col = "orange", ylim = c(-0.5,1),
xlab =  "Setting",
ylab = "Mean 5-fold CV PA across 100 replicate traits")
points(this.mean, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
#set dir to save into this codes folder
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H6/Simulation/Simulated_Traits/Large qtl H0.5/")
home.dir <- getwd()
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/Initial_Test_Pipeline/H4/Simulation/AEL_Experimental/")
#if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
library(mvtnorm, lqmm)
#install.packages("readx1")
library(readxl)
library(simplePHENOTYPES)
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H6/Simulation/")
data <- read.delim("Genotype.H6.rf.filter.in.Hapmap.Format.NA.as.N.txt", head = TRUE)
# Print the modified data frame - please use "View" instead of print
View(data)
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H6/Simulation/Simulated_Traits/Large qtl H0.5")
home.dir <- getwd()
#single trait
create_phenotypes(
geno_obj = data,
add_QTN_num = 5,
add_effect = 0.6,
rep = 100,
h2 = 0.2,
model = "A",
home_dir = home.dir,
output_format = "wide"
)
#single trait
create_phenotypes(
geno_obj = data,
add_QTN_num = 5,
add_effect = 0.6,
rep = 100,
h2 = 0.5,
model = "A",
home_dir = home.dir,
output_format = "wide"
)
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "many small qtl H0.2"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.2/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.2.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.2/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.2.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "many small qtl H0.5"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.5/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.5.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.5/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.5.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "many small qtl H0.8"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.8/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.8.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.8/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.8.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
pdng(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "several medium qtl H0.2"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/several medium qtl H0.2/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.2.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/several medium qtl H0.2/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.2.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "yellow",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "yellow",
xlab = "several medium qtl H0.2 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "several medium qtl H0.5"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/several medium qtl H0.5/Mean.5.fold.CV.PA.H4.several medium qtl H0.5.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/several medium qtl H0.5/Mean.5.fold.CV.PA.H4.several medium qtl H0.5.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "yellow",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "yellow",
xlab = "Several medium qtl H0.5 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "several medium qtl H0.8"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/several medium qtl H0.8/Mean.5.fold.CV.PA.H4.several medium qtl H0.8.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/several medium qtl H0.8/Mean.5.fold.CV.PA.H4.several medium qtl H0.8.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "yellow",
xlab = "several medium qtl H0.8 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "yellow",
xlab = "several medium qtl H0.8 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "many small qtl H0.2"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.2/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.2.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.2/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.2.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "Many small qtl H0.2 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "many small qtl H0.5"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.5/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.5.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.5/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.5.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "Many small qtl H0.5 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "many small qtl H0.8"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.8/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.8.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/many small qtl H0.8/Mean.5.fold.CV.PA.H4.many.small.qtl.H0.8.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
pdng(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "Many small qtl H0.8 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "Red",
xlab = "Many small qtl H0.8 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "5 Large qtl H0.2"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/Large qtl H0.2/Mean.5.fold.CV.PA.H4.Large qtl H0.2.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/Large qtl H0.2/Mean.5.fold.CV.PA.H4.Large qtl H0.2.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "green",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "green",
xlab = "5 Large qtl H0.2 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "5 large qtl H0.5"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/Large qtl H0.5/Mean.5.fold.CV.PA.H4.Large qtl H0.5.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/Large qtl H0.5/Mean.5.fold.CV.PA.H4.Large qtl H0.5.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "green",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "green",
xlab = "5 large qtl H0.5 H4", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
# Set the working directory to the directory where you want to save the boxplots
setwd("/Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/")
this.setting <- "5 Large qtl H0.8"
this.population <- "H4"
#Idenfiy the complete path to the corresponding RR-BLUP and MultiBLUP results for a given simualtion setting
file_paths <- c(
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/Large qtl H0.8/Mean.5.fold.CV.PA.H4.Large qtl H0.8.RRBLUP.csv",
"C://Users/sarahjw2/Box/Widener_Lipka_Shared_Folder/TLI/Genomic_Selection/H4/Simulation/Simulated_Traits/Large qtl H0.8/Mean.5.fold.CV.PA.H4.Large qtl H0.8.multiBLUP.csv"
)
results.RRBLUP <- read.csv(paste(file_paths[1], sep = ""), head = TRUE)
results.MultiBLUP <- read.csv(paste(file_paths[2], sep = ""), head = TRUE)
#Sarah and Alex noticed that results.RRBLUP and results.MultiBLUP have
# the same column names. Also we don't need the first column in
# both of these files to make the box plot
colnames(results.RRBLUP)[2] <- "Mean_RRBLUP"
colnames(results.MultiBLUP)[2] <- "Mean_MultiBLUP"
#Use cbind to join results.RRBLUP and resutls MultiBLUP
results.both <- data.frame(results.RRBLUP[,-1], results.MultiBLUP[,-1])
#"Melt" the data so that they are formatted for making a box plot
library(reshape2)
results.melted.for.boxplot <- melt(data = results.both, measure.vars = colnames(results.both))
means <- c(mean(results.both$results.RRBLUP....1., na.rm = TRUE), mean(results.both$results.MultiBLUP....1., na.rm = TRUE) )
pdf(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".pdf", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "green",
xlab = "GS Model", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
png(paste("RRBLUP.vs.Multiblup", this.population, ".", this.setting, ".png", sep= ""))
boxplot(results.melted.for.boxplot$value ~ results.melted.for.boxplot$variable, col = "green",
xlab = "5 Large qtl H0.8", ylab = "Predictive Ability", ylim = c(-0.5, 1.5))
points(c(1:length(means)), means, pch = 3, cex = 0.75) #Adds the means, which are indicated by the "+" symbol
dev.off()
